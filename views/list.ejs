<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel="stylesheet">
</head>
<body class="grey-bg">

    <%- include('nav.ejs') %>

    <div class="white-bg">
        <% for(let i = 0; i < post.length; i++) { %>
            <% let addr = 'post[i]._id' %>
            <div class="list-box">
              <h4><a href="/detail/<%= post[i]._id %>" ><%= post[i].title %></a></h4>
              <span class="delete" data-id="<%= post[i]._id%>">🗑️</span>
              <p><%= post[i].content %></p>
            </div>
        <% } %>

    </div> 

    <script>      
        for(let i = 0; i < '<%= post.length %>'; i++)
        {
            document.querySelectorAll('.delete')[i]
            .addEventListener('click', function(e){
                fetch('/abc', {
                    method: 'delete',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ _id: e.target.dataset.id })
                })
                .then((r)=>r.text())
                .then((r)=>{
                    e.target.parentElement.parentElement.style.display = 'none'
                })
            })
        }

    </script>
  
  </body>
</html>